{% load i18n %}

<div class="modal-body px-4 py-3">
    <p>
        {% blocktrans %}
        The leaderboard uses the
        <strong>Sudoku Power Index (SPI)</strong> — a score from 0 to 100 that rewards
        <em>fast</em> solves on <em>difficult</em> puzzles and consistent performance.
        {% endblocktrans %}
    </p>

    <hr class="my-4">

    <h6 class="fw-bold mb-2">{% trans "Per‑puzzle contribution" %}</h6>
    <p>
        {% blocktrans %}
        Each time you solve a puzzle, you earn a score \( S_{u,s} \) that reflects your relative performance:
        {% endblocktrans %}
    </p>

    <div class="text-center mb-3">
        <p class="text-primary">\[\displaystyle S_{u,s} = \bar{t}_s \cdot \frac{\bar{t}_s}{t_{u,s}}\]</p>
    </div>

    <p>
        {% blocktrans %}
        This value increases if you solve the puzzle faster than average — and especially so if it's a tough puzzle.
        {% endblocktrans %}
    </p>

    <table class="table table-sm table-bordered w-auto mx-auto my-4">
        <thead class="table-light">
        <tr>
            <th>{% trans "Symbol" %}</th>
            <th>{% trans "Meaning" %}</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>\( \bar{t}_s \)</td>
            <td>{% trans "Average solve time for puzzle \(s\)" %}</td>
        </tr>
        <tr>
            <td>\( t_{u,s} \)</td>
            <td>{% trans "Your time to solve puzzle \(s\)" %}</td>
        </tr>
        </tbody>
    </table>

    <hr class="my-4">

    <h6 class="fw-bold mb-2">{% trans "User rating" %}</h6>
    <p>
        {% blocktrans %}
        Your rating \( R_u \) is the average of your scores from the <strong>last 100 puzzles</strong> you've completed:
        {% endblocktrans %}
    </p>

    <div class="text-center mb-3">
        <p class="text-primary">\[\displaystyle R_u = \frac{1}{N_u} \sum_{s=1}^{N_u} S_{u,s}\]</p>
    </div>

    <p>
        {% blocktrans %}
        This average rewards players who solve puzzles quickly and consistently — only your most recent solves count.
        {% endblocktrans %}
    </p>

    <hr class="my-4">

    <h6 class="fw-bold mb-2">{% trans "Volume weight" %}</h6>
    <p>
        {% blocktrans %}
        To prevent high ratings from just one or two good performances, your score is scaled by how many puzzles you've recently solved:
        {% endblocktrans %}
    </p>

    <div class="text-center mb-4">
        <p class="text-primary">\[\displaystyle V_u = 1 - e^{-\lambda N_u} \quad \text{with } \lambda = 0.2\]</p>
        <p class="text-primary">\[\displaystyle R'_u = R_u \cdot V_u\]</p>
    </div>

    <p>
        {% blocktrans %}
        Only those with consistent activity across many puzzles can reach the top.
        {% endblocktrans %}
    </p>

    <hr class="my-4">

    <h6 class="fw-bold mb-2">{% trans "Leaderboard score" %}</h6>
    <p>
        {% blocktrans %}
        All adjusted scores \( R'_u \) are normalized so that the top player always has a score of 100:
        {% endblocktrans %}
    </p>

    <div class="text-center mb-4">
        <p class="text-primary">\[\displaystyle \text{SPI}_u = 100 \cdot \frac{R'_u}{\max\limits_v R'_v}\]</p>
    </div>

    <p>
        {% blocktrans %}
        The closer your performance is to the best, the closer your SPI will be to 100.
        {% endblocktrans %}
    </p>
</div>
